

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2-D Fitting in Sherpa &mdash; Python4Astronomers v1.0 documentation</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Python4Astronomers v1.0 documentation" href="../index.html" />
    <link rel="up" title="Fitting and Modeling 1-D and 2-D Data" href="fitting.html" />
    <link rel="prev" title="1-D Fitting in Sherpa" href="spectrum.html" />
 
<script type="text/javascript"> 
$(document).ready(function(){

$(".flip0").click(function(){
    $(".panel0").slideToggle("normal");
  });

$(".flip1").click(function(){
    $(".panel1").slideToggle("normal");
  });

$(".flip2").click(function(){
    $(".panel2").slideToggle("normal");
  });

$(".flip3").click(function(){
    $(".panel3").slideToggle("normal");
  });

$(".flip4").click(function(){
    $(".panel4").slideToggle("normal");
  });

$(".flip5").click(function(){
    $(".panel5").slideToggle("normal");
  });

$(".flip6").click(function(){
    $(".panel6").slideToggle("normal");
  });

$(".flip7").click(function(){
    $(".panel7").slideToggle("normal");
  });

$(".flip8").click(function(){
    $(".panel8").slideToggle("normal");
  });

$(".flip9").click(function(){
    $(".panel9").slideToggle("normal");
  });

});
</script>
 
<style type="text/css"> 

div.panel0,p.flip0
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip0
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel0
{
display:none;
}

div.panel1,p.flip1
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip1
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel1
{
display:none;
}

div.panel2,p.flip2
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip2
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel2
{
display:none;
}

div.panel3,p.flip3
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip3
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel3
{
display:none;
}

div.panel4,p.flip4
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip4
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel4
{
display:none;
}

div.panel5,p.flip5
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip5
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel5
{
display:none;
}

div.panel6,p.flip6
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip6
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel6
{
display:none;
}

div.panel7,p.flip7
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip7
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel7
{
display:none;
}

div.panel8,p.flip8
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip8
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel8
{
display:none;
}

div.panel9,p.flip9
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip9
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel9
{
display:none;
}

</style>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="spectrum.html" title="1-D Fitting in Sherpa"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Python4Astronomers v1.0 documentation</a> &raquo;</li>
          <li><a href="fitting.html" accesskey="U">Fitting and Modeling 1-D and 2-D Data</a> &raquo;</li> 
      </ul>
    </div>

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="d-fitting-in-sherpa">
<h1>2-D Fitting in Sherpa<a class="headerlink" href="#d-fitting-in-sherpa" title="Permalink to this headline">Â¶</a></h1>
<p>Fit image data of a supernova remnant G21.5-0.9 using a 2-D multi-component
source model.  First, download the FITS image of <a class="reference download internal" href="../_downloads/image2.fits"><tt class="xref download docutils literal"><span class="pre">G21.5-0.9</span></tt></a>
and start IPython:</p>
<div class="highlight-python"><pre>$ ipython -pylab</pre>
</div>
<p>If you have trouble accessing the image you can download it straight away using
Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">urllib2</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">&quot;http://python4astronomers.github.com/_downloads/image2.fits&quot;</span>
<span class="nb">open</span><span class="p">(</span><span class="s">&quot;image2.fits&quot;</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="n">ls</span>
</pre></div>
</div>
<p>Import the Sherpa&#8217;s high-level UI with added routines for astronomy:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sherpa.astro.ui</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>Load in the FITS image using Sherpa&#8217;s <tt class="docutils literal"><span class="pre">load_data</span></tt>.  Sherpa includes built-in
convienence routines for reading FITS tables and images using pyFITS.  Show the
image using <tt class="docutils literal"><span class="pre">image_data</span></tt> in DS9:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">load_data</span><span class="p">(</span><span class="s">&quot;image2.fits&quot;</span><span class="p">)</span>
<span class="n">image_data</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/g21.png"><img alt="../_images/g21.png" src="../_images/g21.png" style="width: 406.5px; height: 567.0px;" /></a>
<p>Calculate the number of source counts in the full FOV:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">calc_data_sum2d</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition-result admonition ">
<p class="first admonition-title">Result</p>
<p class="last">32300</p>
</div>
<p>Typically, X-ray data from Chandra contain low counts, so we will switch over
to a maximum likelihood statistic such as <cite>Cash</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">set_stat</span><span class="p">(</span><span class="s">&quot;cash&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The default fitting method, least squares, is not suitable for fitting low-count
data such as X-ray images, so we will choose <cite>Simplex</cite> as the optimization
method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">set_method</span><span class="p">(</span><span class="s">&quot;simplex&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Set the coordinate system for this image to use <cite>physical</cite> coordinates with
<tt class="docutils literal"><span class="pre">set_coord</span></tt> (Chandra chip coordinates).  Valid coordinate systems include
<cite>image</cite>, <cite>physical</cite>, and <cite>wcs</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">set_coord</span><span class="p">(</span><span class="s">&quot;physical&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we will setup a 2-D region to filter the image.  Here we define a 2-D
<cite>CIRCLE</cite> with <cite>x</cite> and <cite>y</cite> defined in physical coordinates and the <cite>radius</cite>
defined in pixels:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">notice2d</span><span class="p">(</span><span class="s">&quot;CIRCLE(4072.46,4249.34,108)&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">get_filter</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The coordinate system of the data must match the coordinate system used in
the 2-D region definition.  Typically, a call to <tt class="docutils literal"><span class="pre">set_coord</span></tt> is made before
using <tt class="docutils literal"><span class="pre">notice2d</span></tt> or <tt class="docutils literal"><span class="pre">ignore2d</span></tt>.</p>
</div>
<div class="admonition-sherpa-also-supports-2-d-regions-from-file-either-ascii-or-fits admonition ">
<p class="first admonition-title">Sherpa also supports 2-D regions from file (either ASCII or FITS).</p>
<p>Sherpa supports CIAO region files to define 2-D noticed regions:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">ignore2d</span><span class="p">()</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">file</span><span class="p">(</span><span class="s">&quot;circle.reg&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;CIRCLE(4072.46,4249.34,108)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">notice2d</span><span class="p">(</span><span class="s">&quot;circle.reg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>View the filtered image data in DS9:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">image_data</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/g21_filter.png"><img alt="../_images/g21_filter.png" src="../_images/g21_filter.png" style="width: 406.5px; height: 567.0px;" /></a>
<p>Calculate the source counts inside the noticed 2-D region:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">calc_data_sum2d</span><span class="p">(</span><span class="s">&quot;CIRCLE(4072.46,4249.34,108)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-result admonition ">
<p class="first admonition-title">Result</p>
<p class="last">24658</p>
</div>
<p>Define a 2-D Gaussian as the source model.  This example is simply an
illustration for describing the source emission.  Initialize the parameter
values according to coordinate system.  The <cite>xpos</cite> and <cite>ypos</cite> parameters are in
<cite>physical</cite> coordinates:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">set_source</span><span class="p">(</span><span class="n">gauss2d</span><span class="o">.</span><span class="n">g1</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">ampl</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">g1</span><span class="o">.</span><span class="n">fwhm</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">g1</span><span class="o">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="mf">4065.5</span>
<span class="n">g1</span><span class="o">.</span><span class="n">ypos</span> <span class="o">=</span> <span class="mf">4250.5</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> The function <tt class="docutils literal"><span class="pre">set_source</span></tt> is synonymous to <tt class="docutils literal"><span class="pre">set_model</span></tt></p>
<p>Next, constraint the parameter limits to roughly the size of the image:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">g1</span><span class="o">.</span><span class="n">fwhm</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="mi">4300</span>
<span class="n">g1</span><span class="o">.</span><span class="n">xpos</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="mi">4300</span>
<span class="n">g1</span><span class="o">.</span><span class="n">ypos</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="mi">4300</span>
<span class="n">g1</span><span class="o">.</span><span class="n">ampl</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">g1</span><span class="o">.</span><span class="n">ampl</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="mi">1000</span>
</pre></div>
</div>
<p>View the current model definition and view the 2-D Gaussian in DS9:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">get_model</span><span class="p">()</span>
<span class="n">image_model</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/g21_model.png"><img alt="../_images/g21_model.png" src="../_images/g21_model.png" style="width: 406.5px; height: 567.0px;" /></a>
<p>Calculate the Gaussian model counts inside the noticed 2-D region:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">calc_model_sum2d</span><span class="p">(</span><span class="s">&quot;CIRCLE(4072.46,4249.34,108)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-result admonition ">
<p class="first admonition-title">Result</p>
<p class="last">2266.1800709135932</p>
</div>
<p>Now, include a background component to the source model.  In this case, an
estimate of (0.2) is made from the radial profile:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">set_source</span><span class="p">(</span><span class="n">g1</span><span class="o">+</span><span class="n">const2d</span><span class="o">.</span><span class="n">bgnd</span><span class="p">)</span>
<span class="n">bgnd</span><span class="o">.</span><span class="n">c0</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">bgnd</span><span class="o">.</span><span class="n">c0</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
<p>View the updated model expression:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">get_model</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> The function <tt class="docutils literal"><span class="pre">get_model</span></tt> is <strong>not</strong> synonymous to <tt class="docutils literal"><span class="pre">get_source</span></tt>.
Typically, Sherpa functions that end in <tt class="docutils literal"><span class="pre">_source</span></tt> refer to unconvolved model
components (e.g. components to be convolved with a Point Spread Function
(PSF)).  Sherpa functions that end in <tt class="docutils literal"><span class="pre">_model</span></tt> access the complete convolved
model expression including any convolution components (e.g. PSF).</p>
<p>Fit with <tt class="docutils literal"><span class="pre">fit</span></tt> and display the data, model, and residuals in DS9 with
<tt class="docutils literal"><span class="pre">image_fit</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fit</span><span class="p">()</span>
<span class="n">image_fit</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition-fit-result admonition ">
<p class="first admonition-title">Fit Result</p>
<p class="last">Sherpa fit results include the statistic and method used during fitting,
goodness-of-fit indicators, the number of function evaluations computed, and
the list of best-fit parameter values.  NOTE: only the thawed parameters are
shown.</p>
</div>
<pre><p>Dataset               = 1
Method                = neldermead
Statistic             = cash
Initial fit statistic = 20661.5
Final fit statistic   = -48907.8 at function evaluation 525
Data points           = 9171
Degrees of freedom    = 9166
Change in statistic   = 69569.3
g1.fwhm        57.9477
g1.xpos        4070.4
g1.ypos        4251.11
g1.ampl        23.3562
bgnd.c0        0.266365</p>
</pre><a class="reference internal image-reference" href="../_images/g21_fit.png"><img alt="../_images/g21_fit.png" src="../_images/g21_fit.png" style="width: 405.75px; height: 567.0px;" /></a>
<p>Calculate the model counts inside the noticed 2-D region using the best-fit
parameter values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">calc_model_sum2d</span><span class="p">(</span><span class="s">&quot;CIRCLE(4072.46,4249.34,108)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-result admonition ">
<p class="first admonition-title">Result</p>
<p class="last">24658.000000637512</p>
</div>
<p>Calculate the FWHM in arcseconds using the ACIS conversion factor by accessing
the parameter value with the attribute <tt class="docutils literal"><span class="pre">val</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">g1</span><span class="o">.</span><span class="n">fwhm</span><span class="o">.</span><span class="n">val</span> <span class="o">*</span> <span class="mf">0.492</span>
</pre></div>
</div>
<div class="admonition-result admonition ">
<p class="first admonition-title">Result</p>
<p class="last">28.510281281152213</p>
</div>
<p>Save the fitted model to a FITS image using <tt class="docutils literal"><span class="pre">save_model</span></tt> and save the fit
residuals using <tt class="docutils literal"><span class="pre">save_resid</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">save_model</span><span class="p">(</span><span class="s">&quot;model.fits&quot;</span><span class="p">,</span> <span class="n">clobber</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">save_resid</span><span class="p">(</span><span class="s">&quot;resid.fits&quot;</span><span class="p">,</span> <span class="n">clobber</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the parameter confidence limits on thawed parameter values using the
Sherpa method <tt class="docutils literal"><span class="pre">conf</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">set_conf_opt</span><span class="p">(</span><span class="s">&quot;sigma&quot;</span><span class="p">,</span> <span class="mf">1.6448536269514722</span><span class="p">)</span>
<span class="n">conf</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition-confidence-result admonition ">
<p class="first admonition-title">Confidence Result</p>
<p class="last">Sherpa confidence results include the statistic and method used during, a list
of best-fit parameter values, and their associated confidence limits.  NOTE:
only the thawed parameters or specified parameters are shown.</p>
</div>
<pre><p>g1.ampl lower bound:    -0.399122
g1.fwhm lower bound:    -0.465406
g1.ampl upper bound:    0.405767
g1.fwhm upper bound:    0.467569
bgnd.c0 lower bound:    -0.0152336
g1.xpos lower bound:    -0.297327
g1.xpos upper bound:    0.297382
g1.ypos lower bound:    -0.294267
g1.ypos upper bound:    0.294294
bgnd.c0 upper bound:    0.0156245
Dataset               = 1
Confidence Method     = confidence
Iterative Fit Method  = None
Fitting Method        = neldermead
Statistic             = cash
confidence 1.64485-sigma (90%) bounds:
Param            Best-Fit  Lower Bound  Upper Bound
=====            ========  ===========  ===========
g1.fwhm           57.9477    -0.465406     0.467569
g1.xpos            4070.4    -0.297327     0.297382
g1.ypos           4251.11    -0.294267     0.294294
g1.ampl           23.3562    -0.399122     0.405767
bgnd.c0          0.266365   -0.0152336    0.0156245</p>
</pre><div class="admonition-exercise-for-the-interested-reader-scipy-special-functions admonition ">
<p class="first admonition-title">Exercise (for the interested reader): SciPy special functions</p>
<p>Sherpa does not yet support the feature to indicate the confidence as a
percentage.  How can we convert the desired percentage to the sigma that
Sherpa supports?</p>
<p class="last">(Hint): Try <tt class="docutils literal"><span class="pre">scipy.special.erfinv</span></tt></p>
</div>
<div class="panel0"><p>Typically, the confidence is calculated from sigma using the error-function,
ERF(sigma/SQRT(2)).  We can invert this operation using the inverse
error-function found in SciPy in the special functions module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">scipy.special</span>
<span class="k">print</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">erfinv</span><span class="p">(</span><span class="mf">0.90</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div> <p class="flip0">Click to Show/Hide Solution</p><p>Notice how the parameter confidence limits are displayed as soon as they are
known.  The parameter confidence limits are accessed using <tt class="docutils literal"><span class="pre">get_conf_results</span></tt>.
Save the 90% calculated parameter limits:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">results</span> <span class="o">=</span> <span class="n">get_conf_results</span><span class="p">()</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">file</span><span class="p">(</span><span class="s">&quot;fit_results.out&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;NAME VALUE MIN MAX</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">minval</span><span class="p">,</span> <span class="n">maxval</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">parnames</span><span class="p">,</span><span class="n">results</span><span class="o">.</span><span class="n">parvals</span><span class="p">,</span><span class="n">results</span><span class="o">.</span><span class="n">parmins</span><span class="p">,</span><span class="n">results</span><span class="o">.</span><span class="n">parmaxes</span><span class="p">):</span>
    <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="o">+</span><span class="n">minval</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="o">+</span><span class="n">maxval</span><span class="p">)]</span>
    <span class="k">print</span> <span class="n">line</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>View the new output file:</p>
<div class="highlight-python"><pre>!cat fit_results.out</pre>
</div>
<p>Notice how the function <tt class="docutils literal"><span class="pre">zip</span></tt> rotates the list of tuples into rows of names,
values, min values, and max values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">tbl</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">parnames</span><span class="p">,</span><span class="n">results</span><span class="o">.</span><span class="n">parvals</span><span class="p">,</span><span class="n">results</span><span class="o">.</span><span class="n">parmins</span><span class="p">,</span><span class="n">results</span><span class="o">.</span><span class="n">parmaxes</span><span class="p">)</span>
<span class="k">print</span> <span class="n">tbl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="spectrum.html" title="1-D Fitting in Sherpa"
             >previous</a> |</li>
        <li><a href="../index.html">Python4Astronomers v1.0 documentation</a> &raquo;</li>
          <li><a href="fitting.html" >Fitting and Modeling 1-D and 2-D Data</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Smithsonian Astrophysical Observatory.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.5.
    </div>
  </body>
</html>